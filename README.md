# YOYOæµåª’ä½“å¹³å° - å®‰å…¨å®æ—¶ç›´æ’­ä¸ç›‘æ§å¹³å°

## ğŸ§© é¡¹ç›®ç®€ä»‹

YOYOæµåª’ä½“å¹³å°æ˜¯ä¸€ä¸ªé¢å‘å¤šç§å®æ—¶ç›‘æ§ä¸ç›´æ’­åœºæ™¯çš„**å®‰å…¨ç›´æ’­ / å›æ”¾ä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆ**ï¼Œé‡‡ç”¨ã€Œå‰ç«¯ + Cloudflare Workers + VPS è½¬ç ã€çš„ä¸‰å±‚æ¶æ„ï¼Œé€šè¿‡ Cloudflare è¾¹ç¼˜ç½‘ç»œ + VPS è½¬ç æœåŠ¡ï¼Œå®ç°ï¼š

- æ”¯æŒå¤šç”¨æˆ·ã€å¤šé¢‘é“çš„å®æ—¶è§†é¢‘æµæ’­æ”¾ä¸å½•åˆ¶ï¼›
- ç®¡ç†å‘˜å¯åœ¨åå°é›†ä¸­ç®¡ç†é¢‘é“ã€é¢„åŠ è½½ä¸å®šæ—¶å½•åˆ¶ç­–ç•¥ï¼›
- ç»“åˆ Cloudflare Tunnel éšè— VPS æºç«™ IPï¼Œé™ä½è¢«æ”»å‡»é£é™©ã€‚

æœ¬ä»“åº“åŒ…å«å®Œæ•´çš„ä¸‰ç«¯ä»£ç ï¼šCloudflare Workerï¼ˆåç«¯ API ç½‘å…³ï¼‰ã€Vue å‰ç«¯å’Œ VPS è½¬ç æœåŠ¡ç«¯ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **å®‰å…¨è®¿é—®ä¸éšè—æºç«™**ï¼š
  - å‰ç«¯ä¸ç®¡ç†åå°åªè®¿é—® Cloudflare Workers åŸŸåï¼›
  - é€šè¿‡ Cloudflare Tunnel è®¿é—® VPSï¼Œæ— éœ€åœ¨é˜²ç«å¢™æš´éœ²è½¬ç ç«¯å£ã€‚

- **å¤šé¢‘é“ç›´æ’­ + å½•åˆ¶ç®¡ç†**ï¼š
  - æ”¯æŒå¤šä¸ª RTMP é¢‘é“é…ç½®ã€æ’åºä¸å¯åœï¼›
  - ä¸€é”®å¼€å¯ / å…³é—­é¢‘é“é¢„åŠ è½½ä¸å®šæ—¶å½•åˆ¶ã€‚

- **æ™ºèƒ½é¢„åŠ è½½ä¸å®šæ—¶ä»»åŠ¡ä½“ç³»**ï¼š
  - æ”¯æŒæŒ‰å·¥ä½œæ—¥ / æ—¶é—´æ®µè§„åˆ™è‡ªåŠ¨å¯åŠ¨æˆ–åœæ­¢è½¬ç ï¼›
  - å†…ç½®å½•åˆ¶æ–‡ä»¶ä¿ç•™ç­–ç•¥ä¸å®šæœŸæ¸…ç†ä»»åŠ¡ã€‚

- **åŒç»´åº¦è·¯ç”±ä¸ Workers æµå…±äº«ç¼“å­˜**ï¼š
  - å‰ç«¯è·¯å¾„ï¼ˆPages / Tunnelï¼‰+ åç«¯è·¯å¾„ï¼ˆç›´è¿ / ä»£ç†ï¼‰çš„ç»„åˆè·¯ç”±ï¼Œæé«˜å¯ç”¨æ€§ï¼›
  - HLS åˆ†ç‰‡åœ¨ Workers ç¼“å­˜ï¼Œå¤šç«¯è§‚çœ‹å…±ç”¨ä¸€æ¡è½¬ç æµï¼Œæ˜¾è‘—èŠ‚çœ VPS å¸¦å®½ã€‚

- **å‰åç«¯å®Œå…¨å¼€æºï¼Œä¾¿äºäºŒæ¬¡å¼€å‘**ï¼š
  - æ‰€æœ‰æ ¸å¿ƒé€»è¾‘å¼€æ”¾ï¼Œæ–¹ä¾¿å®‰å…¨å®¡è®¡ä¸ç§æœ‰åŒ–éƒ¨ç½²ã€‚

## ğŸ—ï¸ æ•´ä½“æ¶æ„ä¸€è§ˆ

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯å±‚: Vue 3 + Element Plus + hls.js       â”‚
â”‚ åŸŸå: https://yoyo.your-domain.com          â”‚
â”‚ éƒ¨ç½²: Cloudflare Pages                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸šåŠ¡å±‚: Cloudflare Workers                  â”‚
â”‚ åŸŸå: https://yoyoapi.your-domain.com       â”‚
â”‚ åŠŸèƒ½: API æœåŠ¡ã€è·¯ç”±å†³ç­–ã€ç”¨æˆ·è®¤è¯ã€HLS ç¼“å­˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è½¬ç å±‚: Node.js + FFmpeg (VPS)              â”‚
â”‚ åŸŸå: https://yoyo-vps.your-domain.com      â”‚
â”‚ åŠŸèƒ½: RTMP â†’ HLS è½¬ç ã€è¿›ç¨‹ç®¡ç†ã€ä»£ç†æœåŠ¡     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æ¨¡å—åˆ’åˆ†ï¼ˆç®€ç‰ˆï¼‰

- **å‰ç«¯å±‚ï¼ˆCloudflare Pages + Vue 3ï¼‰**ï¼šé¢‘é“åˆ—è¡¨ã€æ’­æ”¾å™¨ç•Œé¢ã€ç”¨æˆ·ç™»å½•ä¸æƒé™æ§åˆ¶ï¼Œå¹¶å±•ç¤ºå½“å‰è·¯ç”±æ¨¡å¼ã€‚
- **ä¸šåŠ¡å±‚ï¼ˆCloudflare Workersï¼‰**ï¼šç»Ÿä¸€ API ç½‘å…³ã€ç”¨æˆ·ä¸é¢‘é“ç®¡ç†ã€é¢„åŠ è½½é…ç½®ã€HLS åˆ†ç‰‡ç¼“å­˜ã€éš§é“ä»£ç†ä¸è·¯ç”±å†³ç­–ã€‚
- **è½¬ç å±‚ï¼ˆVPS + Node.js + FFmpeg + Nginxï¼‰**ï¼šRTMP â†’ HLS å®æ—¶è½¬ç ã€è½¬ç è¿›ç¨‹è°ƒåº¦ã€å¤šç”¨æˆ·å…±äº«è½¬ç ã€å½•åˆ¶ä¸è§†é¢‘æ¸…ç†ä»»åŠ¡ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

- **å‰ç«¯**ï¼šVue 3 + Vite + Element Plus
- **è¾¹ç¼˜å±‚**ï¼šCloudflare Workers + KV +ï¼ˆå¯é€‰ï¼‰R2 + Cloudflare Tunnel
- **VPS æœåŠ¡ç«¯**ï¼šNode.js (Express) + FFmpeg + Nginx + PM2

## âš¡ å¿«é€Ÿä¸Šæ‰‹ï¼ˆæ¦‚è§ˆï¼‰

> åªå±•ç¤ºæ•´ä½“æµç¨‹ï¼Œè¯¦ç»†å›¾æ–‡æ­¥éª¤è¯·æŸ¥çœ‹
> [`docs/DEPLOYMENT_GUIDE.md`](./docs/DEPLOYMENT_GUIDE.md)ã€‚
>
> å¦‚éœ€äº†è§£ VPS ä¸€é”®å¸è½½è„šæœ¬çš„è¡Œä¸ºä¸ç”¨æ³•ï¼Œè¯·å‚è§ï¼š
> [`docs/VPS_UNINSTALL_GUIDE.md`](./docs/VPS_UNINSTALL_GUIDE.md)ã€‚

1. åœ¨ Cloudflare ä¸­åˆ›å»º Workerï¼Œéƒ¨ç½² `cloudflare-worker/` ä»£ç å¹¶ç»‘å®šè‡ªå®šä¹‰åŸŸåï¼ˆWorkers API åŸŸåï¼‰ã€‚  
2. åœ¨ VPS ä¸Šæ‰§è¡Œ `vps-server/scripts/vps-oneclick.sh`ï¼Œå®Œæˆ Node.js / FFmpeg / Nginx / PM2 å®‰è£…ä¸æœåŠ¡ç«¯éƒ¨ç½²ã€‚  
3. åœ¨ Cloudflare Zero Trust ä¸­åˆ›å»º Tunnelï¼Œå°† Public Hostname æŒ‡å‘ VPS ä¸Šçš„ Nginx ç«¯å£ã€‚  
4. éƒ¨ç½²å‰ç«¯ï¼ˆå¦‚ Cloudflare Pagesï¼‰ï¼Œå°† API Base URL æŒ‡å‘ Workers API åŸŸåã€‚  
5. é€šè¿‡ç®¡ç†åå°æ·»åŠ é¢‘é“ã€é…ç½®é¢„åŠ è½½ä¸å½•åˆ¶ï¼Œå³å¯å¼€å§‹ä½¿ç”¨ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```text
secure-streaming-platform/
â”‚
â”œâ”€â”€ cloudflare-worker/          # Cloudflare Workersï¼ˆåç«¯APIï¼‰
â”‚   â”œâ”€â”€ src/                    # Workersæºä»£ç 
â”‚   â”‚   â”œâ”€â”€ index.js            # ä¸»å…¥å£æ–‡ä»¶ï¼ˆå•æ–‡ä»¶æ¶æ„ï¼‰
â”‚   â”‚   â””â”€â”€ handlers/           # åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ wrangler.toml           # Workersé…ç½®
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/                   # å‰ç«¯ï¼ˆVue.jsï¼‰
â”‚   â”œâ”€â”€ src/                    # å‰ç«¯æºä»£ç 
â”‚   â”œâ”€â”€ public/                 # é™æ€èµ„æº
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ vps-server/                 # VPSæœåŠ¡ç«¯ï¼ˆNode.jsï¼‰
â”‚   â”œâ”€â”€ src/                    # æœåŠ¡ç«¯æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ routes/             # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â””â”€â”€ middleware/         # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ ecosystem.config.js     # PM2é…ç½®
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ docs/                       # æ–‡æ¡£
â”‚   â”œâ”€â”€ project/                # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ root-legacy/            # é—ç•™æ–‡æ¡£
â”‚   â””â”€â”€ *.md                    # é¡¹ç›®çº§æ–‡æ¡£
â”‚
â”œâ”€â”€ scripts/                    # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ deploy/                 # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ test/                   # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ fix/                    # ä¿®å¤è„šæœ¬
â”‚   â””â”€â”€ utils/                  # å·¥å…·è„šæœ¬
â”‚
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶
â”œâ”€â”€ src/                        # å…±äº«æºä»£ç 
â””â”€â”€ archive/                    # å½’æ¡£æ–‡ä»¶
```

## ğŸš€ éƒ¨ç½²æµç¨‹

> ä¸‹æ–‡ä»…ä¸º **å¿«é€Ÿæ¦‚è§ˆ**ï¼Œå®Œæ•´å›¾æ–‡æ­¥éª¤è¯·å‚è§ï¼š
> [`docs/DEPLOYMENT_GUIDE.md`](./docs/DEPLOYMENT_GUIDE.md)

### 1. Cloudflare Workersï¼ˆåç«¯ API ç½‘å…³ï¼‰

```bash
cd cloudflare-worker
wrangler deploy --env production
```

### 2. Cloudflare Pagesï¼ˆå‰ç«¯ï¼‰

```bash
# è‡ªåŠ¨éƒ¨ç½²ï¼šæäº¤ä»£ç åˆ°GitHub
git push origin master

# æ„å»ºé…ç½®ï¼š
# - Root directory: frontend
# - Build command: npm run build
# - Output directory: dist
```

### 3. VPSæœåŠ¡ç«¯ï¼ˆè½¬ç  + HLSï¼‰

```bash
cd vps-server
pm2 restart ecosystem.config.js
```

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ \docs/\ ç›®å½•ä¸­çš„è¯¦ç»†æ–‡æ¡£ã€‚

å¦‚éœ€ä¸šåŠ¡æˆ–æŠ€æœ¯æ”¯æŒï¼Œå¯å‘é€é‚®ä»¶è‡³ï¼š`shaoye@262777.xyz`
